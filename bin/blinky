#!/bin/bash


function clean_up {
	echo "Unexporting GPIOs 6 and 5"
	echo 6 > /sys/class/gpio/unexport
	echo 5 > /sys/class/gpio/unexport
	exit
}
trap "clean_up" SIGHUP SIGINT SIGTERM




if [ ! -e /sys/class/gpio/gpio6 ]
then
	echo 6 > /sys/class/gpio/export
fi
while [ ! -e /sys/class/gpio/gpio6 ]; do
	# echo "Waiting for GPIO-6"
	sleep 1
done
while [ ! -w /sys/class/gpio/gpio6 ]; do
	# echo "Waiting for GPIO-6 permissions"
	sleep 1
done
# echo "GPIO-6 READY"

if [ ! -e /sys/class/gpio/gpio5 ]
then
	echo 5 > /sys/class/gpio/export
fi
while [ ! -e /sys/class/gpio/gpio5 ]; do
	# echo "Waiting for GPIO-05"
	sleep 1
done
while [ ! -w /sys/class/gpio/gpio5 ]; do
	# echo "Waiting for GPIO-05 permissions"
	sleep 1
done
# echo "GPIO-05 READY"

echo out > /sys/class/gpio/gpio6/direction
echo out > /sys/class/gpio/gpio5/direction

while true; do
	echo 1 > /sys/class/gpio/gpio6/value
	echo 0 > /sys/class/gpio/gpio5/value
	sleep 1
	echo 1 > /sys/class/gpio/gpio6/value
	echo 1 > /sys/class/gpio/gpio5/value
	sleep 1
	echo 0 > /sys/class/gpio/gpio6/value
	echo 1 > /sys/class/gpio/gpio5/value
	sleep 1
	echo 0 > /sys/class/gpio/gpio6/value
	echo 0 > /sys/class/gpio/gpio5/value
	sleep 1
done
